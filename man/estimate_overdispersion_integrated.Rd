% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{estimate_overdispersion_integrated}
\alias{estimate_overdispersion_integrated}
\title{Integrated overdispersion estimation}
\usage{
estimate_overdispersion_integrated(
  counts,
  alevin_dir,
  n_boot,
  gene_names = NULL,
  transcript_info = NULL,
  method_weights = c(bootstrap = 0.3, moments = 0.5, prior = 0.2),
  min_cells_expr = 10,
  n_cores = 4,
  debug_first_block = FALSE
)
}
\arguments{
\item{counts}{A sparse or dense numeric matrix of raw counts (genes x cells).}

\item{alevin_dir}{Path to the directory containing Alevin output with
bootstrap replicates.}

\item{n_boot}{Integer, number of bootstrap replicates per cell in the
Alevin output.}

\item{gene_names}{Optional character vector of gene names (length equal to
number of rows in \code{counts}). If \code{NULL}, rownames of \code{counts}
are used.}

\item{transcript_info}{Optional path to a transcript info table for computing
transcript complexity (must contain \code{gene_id} column).}

\item{method_weights}{Named numeric vector of weights for combining the three
methods (\code{"bootstrap"}, \code{"moments"}, \code{"prior"}). Will be
normalized to sum to 1.}

\item{min_cells_expr}{Minimum number of expressing cells required for a gene
to be included in moment-based and bootstrap-based estimates.}

\item{n_cores}{Number of parallel cores to use for bootstrap-based estimation.}

\item{debug_first_block}{Logical, if \code{TRUE} only the first bootstrap block
is processed (for debugging).}
}
\value{
A list with elements:
\describe{
\item{\code{overdispersion}}{Final integrated overdispersion estimates.}
\item{\code{od_bootstrap}}{Bootstrap-based estimates.}
\item{\code{od_moments}}{Moment-based estimates.}
\item{\code{od_prior}}{Complexity prior values.}
\item{\code{expr_cells}}{Number of cells expressing each gene.}
\item{\code{features}}{Gene names.}
}
}
\description{
Estimates per-gene overdispersion by integrating three complementary methods:
(1) bootstrap-based estimation from Alevin output, (2) method-of-moments
estimation from normalized counts, and (3) an entropy-based complexity prior
from transcript annotation. Produces a weighted geometric mean of the three
methods, followed by empirical Bayes shrinkage.
}
\details{
The function integrates multiple sources of information on technical noise:
\enumerate{
\item \strong{Bootstrap-based}: computes overdispersion from per-cell bootstrap
replicates in Alevin output.
\item \strong{Moment-based}: uses nonzero normalized counts to estimate variance
inflation relative to the mean.
\item \strong{Complexity prior}: uses transcript-level annotation to adjust
expected variance inflation based on gene complexity.
}
The weighted geometric mean of these three estimates is calculated, then shrunk
toward the robust median for well-observed genes (\eqn{\ge 50} cells).
}
