% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{extract_and_pseudobulk}
\alias{extract_and_pseudobulk}
\title{Extract Common Features and Create a Pseudobulk Matrix Across Samples}
\usage{
extract_and_pseudobulk(seurat_list, assay_name = "RNA")
}
\arguments{
\item{seurat_list}{A list of \code{Seurat} objects containing the assay of interest.}

\item{assay_name}{Character scalar specifying the assay from which to extract counts
(default: \code{"RNA"}).}
}
\value{
A sparse matrix (\code{dgCMatrix}) of pseudobulk counts with features
as rows and samples as columns. Column names correspond to \code{names(seurat_list)},
or are automatically generated if missing.
}
\description{
This function identifies features (e.g., genes) that are common across all
\code{Seurat} objects in a list, extracts their counts from a specified assay,
and aggregates counts across cells within each object to create a pseudobulk
matrix.
}
\details{
The function:
\enumerate{
\item Finds the intersection of feature names across all \code{Seurat} objects.
\item Extracts the raw counts for these common features from the specified assay.
\item Aggregates counts across all cells within each object to produce one pseudobulk
column per sample.
}
}
\examples{
\dontrun{
pb <- extract_and_pseudobulk(my_seurat_list, assay_name = "RNA")
dim(pb) # features x samples
}

}
