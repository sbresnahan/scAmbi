% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{create_within_sample_pseudobulk}
\alias{create_within_sample_pseudobulk}
\title{Create within-sample pseudo-bulk counts}
\usage{
create_within_sample_pseudobulk(seurat_obj, cell_groups, assay_name = "RNA")
}
\arguments{
\item{seurat_obj}{A \code{\link[Seurat]{Seurat}} object containing single-cell
expression data.}

\item{cell_groups}{A named list of character vectors, where each vector
contains the cell barcodes for one group (e.g., from
\code{\link{subsample_cells_for_bcv}}).}

\item{assay_name}{Character scalar. The assay to use for counts extraction
(default: \code{"RNA"}).}
}
\value{
A sparse matrix (\code{dgCMatrix}) with genes as rows and groups as
columns, containing summed counts for each group.
}
\description{
Aggregates single-cell counts from specified cell groups into a
pseudo-bulk count matrix for a given assay.
}
\details{
This function takes a set of predefined groups of cells from a Seurat object
and sums their counts to produce a pseudo-bulk matrix. This can be used for
downstream analysis such as biological coefficient of variation (BCV)
estimation or differential expression at the group level.
}
