% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{estimate_overdispersion_moments}
\alias{estimate_overdispersion_moments}
\title{Estimate overdispersion using method-of-moments}
\usage{
estimate_overdispersion_moments(counts, min_cells = 10, size_factors = NULL)
}
\arguments{
\item{counts}{A numeric or sparse matrix of gene-by-cell counts.}

\item{min_cells}{Minimum number of cells with nonzero expression
required for a gene to be included in estimation. Transcripts with fewer
than this number are assigned an overdispersion of 1.}

\item{size_factors}{Optional numeric vector of size factors for each
cell. If \code{NULL}, they are computed as the column sums of
\code{counts}, median-scaled to 1.}
}
\value{
A numeric vector of overdispersion estimates (length equal to
the number of genes).
}
\description{
Computes per-gene overdispersion estimates from a counts matrix
using a method-of-moments approach. Optionally normalizes counts
by size factors before estimation.
}
\details{
For each gene, nonzero expression values are used to compute the mean
and variance. A pseudocount of 0.1 is added to both before computing
overdispersion (\eqn{OD = (var + 0.1) / (mean + 0.1)}). The estimate
is then shrunk toward 1 based on the number of expressing cells, with
stronger shrinkage for small sample sizes.
}
