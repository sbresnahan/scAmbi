% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{compute_overdisp_sparse_aware}
\alias{compute_overdisp_sparse_aware}
\title{Compute Overdispersion from Alevin Bootstraps}
\usage{
compute_overdisp_sparse_aware(
  alevin_dir,
  n_boot,
  block_cells = 256L,
  n_cores = max(1L, parallel::detectCores() - 1L),
  omp_threads = 2L,
  min_cells_expr = 10,
  pseudocount = 0.1,
  verbose = TRUE,
  debug_first_block = FALSE
)
}
\arguments{
\item{alevin_dir}{Path to the Alevin output directory containing
\code{quants_boot_mat.gz} and associated index files.}

\item{n_boot}{Integer; number of bootstrap replicates per cell.}

\item{block_cells}{Integer; number of cells to process in each parallel block
(e.g., 256). A larger size may be faster but uses more memory.}

\item{n_cores}{Integer; number of parallel cores to use for processing.}

\item{omp_threads}{Integer; number of threads for low-level OpenMP/BLAS
operations within the C++ code.}

\item{min_cells_expr}{Integer; minimum number of cells a gene must be
expressed in to receive a non-trivial overdispersion estimate.}

\item{pseudocount}{Numeric; a small value added to the mean in the
overdispersion calculation (\code{var / (mean + pseudocount)}) to prevent
division by zero.}

\item{verbose}{Logical; if \code{TRUE}, print progress messages.}

\item{debug_first_block}{Logical; if \code{TRUE}, the first block is run in
serial to provide clearer error messages for debugging.}
}
\value{
A list containing:
\describe{
\item{\code{OverDisp}}{A numeric vector of the final per-gene overdispersion estimates.}
\item{\code{DF}}{An integer vector of the number of cells contributing to each gene's estimate (degrees of freedom).}
\item{\code{features}}{A character vector of the gene IDs.}
\item{\code{expr_cells}}{A numeric vector of the total number of cells in which each gene was expressed.}
}
}
\description{
Estimates per-gene overdispersion from Alevin's bootstrap matrices using a
memory-efficient, block-wise computation strategy. This function averages
per-cell overdispersion estimates for each gene and applies light shrinkage
for robustness.
}
