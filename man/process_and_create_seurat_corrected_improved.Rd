% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{process_and_create_seurat_corrected_improved}
\alias{process_and_create_seurat_corrected_improved}
\title{Create a Seurat Object with a Corrected Assay}
\usage{
process_and_create_seurat_corrected_improved(
  sample_id,
  counts,
  od,
  feats,
  cells
)
}
\arguments{
\item{sample_id}{Character string; a unique identifier for the sample, used
for labeling the Seurat object project.}

\item{counts}{A sparse matrix of raw gene-by-cell counts.}

\item{od}{A list returned by \code{\link{estimate_overdispersion_integrated}},
containing the final integrated \code{overdispersion} estimates and its
component values.}

\item{feats}{Character vector of feature (gene) names, which must match the
rownames of the \code{counts} matrix.}

\item{cells}{Character vector of cell barcodes, which must match the
colnames of the \code{counts} matrix.}
}
\value{
A Seurat object with two assays:
\describe{
\item{\code{RNA}}{The original, uncorrected count data.}
\item{\code{RNA_corr}}{The overdispersion-corrected count data. This is set as the default assay.}
}
The object's \code{misc} slot also stores metadata about the correction process.
}
\description{
Generates a Seurat object containing both the original raw counts and an
overdispersion-corrected count assay. Correction is based on integrated
estimates from \code{\link{estimate_overdispersion_integrated}}.
}
\details{
This function creates a Seurat object with the raw counts stored in the default
\code{RNA} assay. It then calculates corrected counts by dividing the raw counts
for each gene by the corresponding integrated overdispersion factor from the
\code{od} object. These corrected counts are stored in a new assay named \code{RNA_corr}.

Both assays are populated with rich feature-level metadata, including the
integrated overdispersion value and its components (bootstrap, moments, prior),
which can be accessed via \code{Misc(seu[["assay"]], "feature_meta")}.
}
